apiVersion: v1
kind: Secret
metadata:
  name: app-secrets
  namespace: default
type: Opaque
data:
  # Base64 encoded secrets
  database-url: {{ b64enc (index . "DATABASE_URL") }}
  api-key: {{ b64enc (index . "API_KEY") }}
  {{- if has "JWT_SECRET" . }}
  jwt-secret: {{ b64enc (index . "JWT_SECRET") }}
  {{- end }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: default
data:
  # Plain text config values
  {{- if has "NODE_ENV" . }}
  NODE_ENV: {{ index . "NODE_ENV" | quote }}
  {{- end }}
  {{- if has "DEBUG" . }}
  DEBUG: {{ index . "DEBUG" | quote }}
  {{- end }}