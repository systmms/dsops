# Use the Nix flake for the development environment
use flake

# Load any local environment variables if they exist
dotenv_if_exists .env.local

# Add project-specific environment variables
export PROJECT_NAME="dsops"
export PROJECT_ROOT="$(pwd)"

# Go configuration (these are also set in flake.nix but good to have explicit)
export CGO_ENABLED=0
export GOFLAGS="-buildvcs=false"

# Development helpers
export DSOPS_CONFIG="$PROJECT_ROOT/dsops.yaml"
export DSOPS_DEBUG=1

# Spec-Kit integration
# Use: uv tool run --from specify-cli specify [command]
# This avoids PATH issues and ensures we use the latest version
alias speckit='uv tool run --from specify-cli specify'

# Provider-specific environment hints
# Users can create .env.local with their actual credentials
export AWS_REGION="${AWS_REGION:-us-east-1}"
export VAULT_ADDR="${VAULT_ADDR:-http://127.0.0.1:8200}"

# Create cache directories if they don't exist
mkdir -p .cache/go-build .cache/go-mod .go bin

echo "âœ… dsops development environment loaded with Nix + direnv"